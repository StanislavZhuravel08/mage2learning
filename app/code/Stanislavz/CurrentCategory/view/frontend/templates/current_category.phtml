<?php
/** @var \Stanislavz\CurrentCategory\Block\RecentlyVisitedCategories $block */
if ($block->pagePreloader->isCustomerLoggedIn()) :
    $categoriesCollection = $block->getRecentlyVisitedCategories();
?>
<ul class="custom-category-crumb-list">
    <?php foreach ($categoriesCollection as $category) : ?>
    <li>
        <ul class="custom-category-crumbs">
            <?php
            foreach ($category->getParentCategoriesList() as $parentCategory) :
            ?>
                <li>
                    <a href="<?= $parentCategory->getUrl(); ?>"><?= $parentCategory->getName(); ?></a>
                </li>
            <?php endforeach; ?>
            <li>
                <a href="<?= $category->getUrl(); ?>"><?= $category->getName(); ?></a>
            </li>
        </ul>
    </li>
    <?php endforeach; ?>
</ul>
<?php else : ?>
<ul class="custom-category-crumb-list" data-bind="scope:'recentCategory'">
    <li>
        <ul>
            <li><a href="#"></a></li>
            <li><a href="#"></a></li>
        </ul>
    </li>
</ul>
<script type="text/x-magento-init">
{
    ".custom-category-crumb-list": {
        "Magento_Ui/js/core/app": {
           "components": {
                "recentCategory": {
                    "component": "Stanislavz_CurrentCategory/js/recentCategory"
                }
            }
        }
    }
}
</script>
<?php endif;